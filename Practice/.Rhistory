col = 'orange', border = 'red')
f_x <- seq(min(f.4.mean), max(f.4.mean), length.out = 1000)
f_y <- dnorm(x=f_x, mean = ex, sd = sqrt(varx/4))
lines(f_x, f_y, lty=2, lwd=2, col='blue')
hist(f.16.mean, probability = T, xlim = c(0.6, 1.6), ylim = c(0, 8),
main='표본크기=16',
xlab = '', ylab = '',
col = 'orange', border = 'red')
f_x <- seq(min(f.16.mean), max(f.16.mean), length.out = 1000)
f_y <- dnorm(x=f_x, mean = ex, sd = sqrt(varx/16))
lines(f_x, f_y, lty=2, lwd=2, col='blue')
hist(f.32.mean, probability = T, xlim = c(0.6, 1.6), ylim = c(0, 8),
main='표본크기=32',
xlab = '', ylab = '',
col = 'orange', border = 'red')
f_x <- seq(min(f.64.mean), max(f.64.mean), length.out = 1000)
f_y <- dnorm(x=f_x, mean = ex, sd = sqrt(varx/64))
lines(f_x, f_y, lty=2, lwd=2, col='blue')
hist(f.64.mean, probability = T, xlim = c(0.6, 1.6), ylim = c(0, 8),
main='표본크기=64',
xlab = '', ylab = '',
col = 'orange', border = 'red')
f_x <- seq(min(f.64.mean), max(f.64.mean), length.out = 1000)
f_y <- dnorm(x=f_x, mean = ex, sd = sqrt(varx/64))
lines(f_x, f_y, lty=2, lwd=2, col='blue')
mtext("표본 변화에 따른 f분포, 자유도=(50, 50)", side = 3, line=1, outer=T)
## 문제 02. 임의 추출 100명
##          4/5가 선호,
##          모비율 p에 대한 신뢰도 95%의 신뢰 구간?
n <- 100
phat <- 0.8
qhat <- 0.2
ll <- phat-1.96*sqrt(phat*qhat/n)
ul <- phat+1.96*sqrt(phat*qhat/n)
ll     # 최솟값
ul     # 최댓값
## 문제 03. 무작위로 1000명 추출,
##          430명이 흡연
##          모비율의 90% 신뢰구간은?
n <- 1000
phat <- 0.43
qhat <- 1-0.43
ll <- phat-1.645*sqrt(phat*qhat/n)
ul <- phat+1.645*sqrt(phat*qhat/n)
ll     # 최솟값
ul     # 최댓값
qhat <- 1-phat
ll <- phat-1.645*sqrt(phat*qhat/n)
ul <- phat+1.645*sqrt(phat*qhat/n)
ll     # 최솟값
ul     # 최댓값
### 연습문제06. 1-Sample T 테스트
## 문제 01. A회사의 건전지의 수명시간 1000
##          무작위로 뽑은 10개
##          980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017
##          모집단과 같다고 할수 있는가?
# H0 : 평균(mu) 같다
# H1 : 평균(mu) 같지 않다
bat <- c(980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017)
n <- length(bat)
n
mu <- 1000
mu
xbar <- mean(bat)
xbar
sdbar <- sd(bat)
sdbar
### 연습문제06. 1-Sample T 테스트
## 문제 01. A회사의 건전지의 수명시간 1000
##          무작위로 뽑은 10개
##          980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017
##          모집단과 같다고 할수 있는가?
# H0 : 평균(mu) 같다
# H1 : 평균(mu) 같지 않다
bat <- c(980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017)
n <- length(bat)
n
mu <- 1000
mu
xbar <- mean(bat)
xbar
sdbar <- sd(bat)
sdbar
# 통계량
t <- (xbar-mu) / (sdbar/sqrt(n))
t
# 유의 수준(양쪽)
alpha <- 0.05/2
c.u <- qt(alpha, df=n-1)
c.u
# 유의 확률
p.value <- 1- pt(t, df=n-1)
p.value*2
t.test(bat, mu=mu, alternative = 'two.sided')
bat <- c(980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017)
n <- length(bat)
n
mu <- 1000
mu
xbar <- mean(bat)
xbar
sdbar <- sd(bat)
sdbar
# 통계량
t <- (xbar-mu) / (sdbar/sqrt(n))
t
# 유의 수준(양쪽)
alpha <- 0.05/2
c.u <- qt(alpha, df=n-1)
c.u
# 유의 확률
bat <- c(980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017)
n <- length(bat)
n
mu <- 1000
mu
xbar <- mean(bat)
xbar
sdbar <- sd(bat)
sdbar
# 통계량
t <- (xbar-mu) / (sdbar/sqrt(n))
t
# 유의 수준(양쪽)
alpha <- 0.05/2
c.u <- qt(alpha, df=n-1)
c.u
# 유의 확률
# 유의 확률
p.value <- 1- pt(t, df=n-1)
p.value*2
t.test(bat, mu=mu, alternative = 'two.sided')
## 문제 02. 학생들의 평균성적은 55점.
##          0교시 수업 후 성적 58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39
##          0교시 수업을 시행한 후, 학생들의 성적은 올랐다고 할 수 있는가?
# H0 : 학생들의 mu = 55 or mu <= 55
# H1 : 학생들의 mu > 55
score <- c(58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39)
## 문제 02. 학생들의 평균성적은 55점.
##          0교시 수업 후 성적 58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39
##          0교시 수업을 시행한 후, 학생들의 성적은 올랐다고 할 수 있는가?
# H0 : 학생들의 mu = 55 or mu <= 55
# H1 : 학생들의 mu > 55
score <- c(58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39)
mu <- 55
xbar <- mean(score)
xbar
sd <- sd(score)
sd
n <- length(score)
n
# 통계량
t <- (xbar-mu) / (sd/sqrt(n))
t
# 유의 수준(한쪽:오른쪽)
alpha <- 0.05
c.u <- 1 - qt(alpha, df=n-1)
c.u
# 유의 확률
p.value <- 1 - pt(t, df=n-1)
p.value
t.test(score, mu=mu, alternative = 'greater')
## 문제 03. 한국인의 1인 1일 평균 알코올 섭취량이 8.1
##          무작위로 뽑은 섭취량 15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97
##          평균 알코올 섭취량이 달라졌다고 할 수 있는가?
# H0 : 한국인의 1인 1일 평균 알코올 섭취량은 8.1로 변화가 없다 mu = 8.1
# H1 : 한국인의 1인 1일 평균 알코올 섭취량은 변화가 있다. m != 8.1
al <- c(15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97)
mu <- 8.1
xbar <- mean(al)
xbar
sd <- sd(al)
sd
n <- length(al)
n
# 통계량
t <- (xbar-mu) / (sd/sqrt(n))
t
# 유의수준(양쪽)
alpha <- 0.05/2
alpha
c.u <- qt(alpha, df=n-1)
c.u                              # 양쪽으로 -2.262157, 2.262157
# 유의확률
p.value <- 1- pt(t, df=n-1)
p.value
t.test(al, mu=mu, alternative = 'two.sided')
# 1. 분산의 동일성 검정
# 영가설 : 오토/수동 집단의 분산은 서로 동일하다.
# 대안가설 : 오토/수동 집단의 분산은 서로 다르다.
str(mtcars)
var.test(mtcars$mpg ~ mtcars$am)
# 2. 모평균의 차이 검정
# 영가설 : am:0의 mpg 평균과 am:1의 mpg 평균의 동일하다. (오토평균-수동평균=0)
# 대안가설 : am:0의 mpg 평균과 am:1의 mpg 평균의 동일하지 않다. (오토평균-수동평균<0)
t.test(mtcars$mpg ~ mtcars$am, mu=0, alternative='two.sided', var.equal=T)
var.test(Cars93$Price ~ Cars93$Origin)
# 2. 모평균의 차이 검정
# 영가설 : USA 집단과 non-USA 집단의 평균은 서로 동일하다.(mu1 - mu2 = 0)
# 영가설 : USA 집단과 non-USA 집단의 평균은 서로 동일하지 않다.(mu1 - mu2 != 0)
t.test(Cars93$Price ~ Cars93$Origin, mu=0, alternative='two.sided', var.equal= F)
## 1. 분산의 동일성 검정
# 영가설 : subcompact 자동차의 분산과 midsize 자도창의 분산은 서로 동일하다. (V1 / V2 = 1)
# 대안가설 : subcompact 자동차의 분산과 midsize 자도창의 분산은 서로 다르다. (V1 / V2 != 1)
var.test(mpg3$hwy ~ mpg3$class)
mpg3 <- mpg %>%
filter(class %in% c('subcompact', 'midsize'))
mpg3_n <- mpg3 %>%
select(class, hwy) %>%
group_by(class) %>%
summarise(mpg3_n = n())
mpg3_n
mpg3_mean <- mpg3 %>%
select(class, hwy) %>%
group_by(class) %>%
summarise(mpg3_mean = mean(hwy))
mpg3_mean
mpg3_sd <- mpg3 %>%
select(class, hwy) %>%
group_by(class) %>%
summarise(mpg3_sd = sd(hwy))
mpg3_sd
## 1. 분산의 동일성 검정
# 영가설 : subcompact 자동차의 분산과 midsize 자도창의 분산은 서로 동일하다. (V1 / V2 = 1)
# 대안가설 : subcompact 자동차의 분산과 midsize 자도창의 분산은 서로 다르다. (V1 / V2 != 1)
var.test(mpg3$hwy ~ mpg3$class)
## 문제 03. mpg 데이터셋에서 다음을 검정해 보시오.
## 문제 03-1. subcompact 자동차와 midsize 자동차의 고속도로 연비
mpg
# 필요 패키지
library(prob)
library(dplyr)
library(ggplot2)
mpg3 <- mpg %>%
filter(class %in% c('subcompact', 'midsize'))
## 1. 분산의 동일성 검정
# 영가설 : subcompact 자동차의 분산과 midsize 자도창의 분산은 서로 동일하다. (V1 / V2 = 1)
# 대안가설 : subcompact 자동차의 분산과 midsize 자도창의 분산은 서로 다르다. (V1 / V2 != 1)
var.test(mpg3$hwy ~ mpg3$class)
## 2. 평균의 동일성 검정
# 영가설 : subcompact 자동차의 hwy와  midsize 자동차의 hwy이 차이가 없다. (mu1 - mu2 = 0)
# 대안가설 : subcompact 자동차의 hwy와  midsize 자동차의 hwy이 차이가 있다.(mu1 - mu2 != 0)
t.test(mpg3$hwy ~ mpg3$class, mu=0, alternative='two.sided', var.equal=T)
mpg3.2 <- mpg %>%
filter(fl %in% c('r', 'p'))
View(mpg3.2)
mpg3.2_n <- mpg3.2 %>%
select(fl, cty) %>%
group_by((fl)) %>%
summarise(mpg3.2_n = n())
mpg3.2_n
mpg3.2_mean <- mpg3.2 %>%
select(fl, cty) %>%
group_by((fl)) %>%
summarise(mpg3.2_mean = mean(cty))
mpg3.2_mean
mpg3.2_sd <- mpg3.2 %>%
select(fl, cty) %>%
group_by((fl)) %>%
summarise(mpg3.2_sd = sd(cty))
mpg3.2_sd
# 1. 분산의 동일성 검정
# 영가설 : 일반휘발유의 도시연비와 고급 휘발유의 도시연비 분산은 같다(v1 / v2 = 1)
# 대안가설 : 일반휘발유의 도시연비와 고급 휘발유의 도시연비 분산은 다르다(v1 / v2 != 1)
var.test(mpg3.2$cty ~ mpg3.2$fl)
# 2. 평균의 동일성 검정
# 영가설 : 일반 휘발유와 고급 휘발유의 cty는 차이가 없다 (mu1 - mu2 = 0)
# 대안가설 : 일반 휘발유와 고급 휘발유의 cty는 차이가 있다 (mu1 - mu2 != 0)
t.test(mpg3.2$cty ~ mpg3.2$fl, mu=0, alternative='two.sided', var.equal=F)
mpg3.3 <- mpg %>%
filter(class == 'subcompact') %>%
filter(drv %in% c('f', 'r'))
mpg3.3
mpg3.3_n <- mpg3.3 %>%
select(drv, cty) %>%
group_by(drv) %>%
summarise(mpg3.3_n = n())
mpg3.3_n
mpg3.3_mean <- mpg3.3 %>%
select(drv, cty) %>%
group_by(drv) %>%
summarise(mpg3.3_mean = mean(cty))
mpg3.3_mean
mpg3.3_sd <- mpg3.3 %>%
select(drv, cty) %>%
group_by(drv) %>%
summarise(mpg3.3_sd = sd(cty))
mpg3.3_sd
# 1. 분산 동일성 검정
# 영가설 : 전륜구동의 도시연비 분산과 후륜구동의 도시연비 분산이 같다 (v1 / v2 = 1)
# 대안가설 : 전륜구동의 도시연비 분산과 후륜구동의  도시연비 분산이 다르다(v1 / v2 != 1)
var.test(mpg3.3$cty ~ mpg3.3$drv)
# 2. 평균 동일성 검정
# 영가설 : 전륜구동과 후륜구동의 cty 차이가 없다 (mu1 - mu2 = 0)
# 대안가설 : 전륜구동과 후륜구동의 cty 차이가 있다 (mu1 - mu2 != 0)
t.test(mpg3.3$cty ~ mpg3.3$drv, mu=0, alternative='two.sided', var.equal=F)
### 연습문제09. Paired sample T 테스트
## 문제 01.
ex7.1 <- data.frame('placebo' =
c(51.4, 52.0, 45.5, 54.5, 52.3, 50.9, 52.7, 50.3, 53.8, 53.1),
'newmedicine' =
c(50.1, 51.5, 45.9, 53.1, 51.8, 50.3, 52.0, 49.9, 52.5, 53.0))
ex7.1
# R로 구해보기
t.test(ex7.1$placebo, ex7.1$newmedicine, paired = T, alternative = 'greater')
# R로 구해보기
t.test(ex7.1$placebo, ex7.1$newmedicine, paired = T, alternative = 'greater')
## 문제 2.
ex7.2 <- data.frame('A' =
c(13.2, 8.2, 10.9, 14.3, 10.7, 6.6, 9.5, 10.8, 8.8, 13.3),
'B' =
c(14.0, 8.8, 11.2, 14.2, 11.8, 6.4, 9.8, 11.3, 9.3, 13.6))
ex7.2
# R로 구하기
t.test(ex7.2$A, ex7.2$B, paired = T, alternative = 'two.sided')
## 문제 02.
ex11.2 <- data.frame('1갑이상' =
c(23, 31, 13, 67),
'1갑이하' =
c(21, 48, 23, 92),
'안피움' =
c(63, 159, 119, 341),
'계' =
c(107, 238, 155, 500))
colnames(ex11.2) <- c('1갑이상', '1갑이하', '안피움', '계')
rownames(ex11.2) <- c('반병이상', '반병이하', '못마심', '계')
ex11.2
# 검정
chisq.test(ex11.2[1:3, 1:3], correct)
# 검정
chisq.test(ex11.2)
# 검정
chisq.test(ex11.2[1:3, 1:3], correct)
# 검정
chisq.test(ex11.2[1:3, 1:3], correct = T)
group <- c(rep("1",10),rep("2",10),rep("3",10))
lake1 <- c(5,7,6,8,6,7,8,8,6,10)
lake2 <- c(6,8,9,11,13,12,10,8,9,10)
lake3 <- c(14,25,26,18,19,22,21,16,20,30)
ppm <- c(lake1,lake2,lake3)
lake <- data.frame(group=group,ppm=ppm)
lake
lake1 <- c(5, 7, 6, 8, 6, 7, 8, 8, 6, 10)
lake2 <- c(6, 8, 9, 11, 13, 12, 10, 8, 9, 10)
lake3 <- c(14, 25, 26, 18, 19, 22, 21, 16, 20, 30)
gruop <- c('1'= 1:length(lake1), '2'=1:length(lake2), '3'=1:length(lake3))
group
group
ppm
lake1 <- c(5,7,6,8,6,7,8,8,6,10)
lake2 <- c(6,8,9,11,13,12,10,8,9,10)
lake3 <- c(14,25,26,18,19,22,21,16,20,30)
ppm <- c(lake1,lake2,lake3)
ppm
lake <- data.frame('group' = group, ppm=c(lake1, lake2, lake3))
lake
lake
# 1. 각 호수의 정규성 검점
shapiro.test(lake1)
qqnorm(lake1); qqline(lake1):
# 영가설 : A 밑창과 B 밑창의 원재료가 닳는 정도의 차이가 없다 (muA - muB = 0)
# 대안가설 : A 밑창과 B 밑창의 원재료가 닳는 정도의 차이가 있다 (muA - muB != 0)
# 직접 검정 통계량 구해보기
n <- length(ex7.2$A - ex7.2$B)
par(mfrow=c(1,1))
qqnorm(lake1); qqline(lake1):
# 영가설 : A 밑창과 B 밑창의 원재료가 닳는 정도의 차이가 없다 (muA - muB = 0)
# 대안가설 : A 밑창과 B 밑창의 원재료가 닳는 정도의 차이가 있다 (muA - muB != 0)
# 직접 검정 통계량 구해보기
n <- length(ex7.2$A - ex7.2$B)
qqnorm(lake1); qqline(lake1);
# 1. 각 호수의 정규성 검점
# 1) lake1
shapiro.test(lake1)
qqnorm(lake1); qqline(lake1);
qqnorm(lake1); qqline(lake1)
# 2) lake2
shapiro.test(lake2)
qqnorm(lake2)
qqnorm(lake2); qqline(lake2)
# 3) lake3
shapiro.test(lake3)
qqnorm(lake3); qqline(lake3)
lake
# 2. anova 검정
anova(lm(ppm ~ group, data = lake))
## 문제 02.
A <- c(15.5, 14.3, 16.3, 13.5, 15.7, 16.4, 14.7)
B <- c(14.7, 16.3, 15.5, 15.2, 16.3, 13.5, 15.4)
C <- c(15.5, 13.2, 16.5, 15.7, 15.3, 15.2, 14.8)
gruop <- c('A'= 1:length(A), 'B'=1:length(B), 'C'=1:length(C))
group
group <- c('A'= 1:length(A), 'B'=1:length(B), 'C'=1:length(C))
group
## 문제 02.
A <- c(15.5, 14.3, 16.3, 13.5, 15.7, 16.4, 14.7)
B <- c(14.7, 16.3, 15.5, 15.2, 16.3, 13.5, 15.4)
C <- c(15.5, 13.2, 16.5, 15.7, 15.3, 15.2, 14.8)
group <- c('1'= 1:length(A), '2'=1:length(B), '3'=1:length(C))
group
### 연습문제10. 일원 분산분석(One way ANOVA)
## 문제 01.
## 문제 01. 3개 호수의 산소량의 차이가 있는지 없는지 알아보자.
lake1 <- c(5, 7, 6, 8, 6, 7, 8, 8, 6, 10)
lake2 <- c(6, 8, 9, 11, 13, 12, 10, 8, 9, 10)
lake3 <- c(14, 25, 26, 18, 19, 22, 21, 16, 20, 30)
gruop <- c('1'= 1:length(lake1), '2'=1:length(lake2), '3'=1:length(lake3))
group
### 연습문제10. 일원 분산분석(One way ANOVA)
## 문제 01.
## 문제 01. 3개 호수의 산소량의 차이가 있는지 없는지 알아보자.
lake1 <- c(5, 7, 6, 8, 6, 7, 8, 8, 6, 10)
lake2 <- c(6, 8, 9, 11, 13, 12, 10, 8, 9, 10)
lake3 <- c(14, 25, 26, 18, 19, 22, 21, 16, 20, 30)
gruop <- c('1'= 1:length(lake1), '2'=1:length(lake2), '3'=1:length(lake3))
group
lake <- data.frame('group' = group, ppm=c(lake1, lake2, lake3))
lake
gruop <- c('1'= 1:10, '2'=11:20, '3'=21:30)
group
group <- c('1'= 1:10, '2'=11:20, '3'=21:30)
group
group <- c(rep('1',10), rep('2',10), rep('3',10))
group
lake <- data.frame('group' = group, ppm=c(lake1, lake2, lake3))
lake
group <- c(rep('1',7), rep('2',7), rep('3',7))
group
vege <- data.frame('group' = group, 'price' = c(A, B, C))
vege
# 1. 정규성 검정
# 1) A채소
shapiro.test(A)
qqnorm(A); qqline(A)
qqnorm(A); qqline(A, col = 'red')
# 2) B채소
shapiro.test(B)
qqnorm(B); qqline(B, col = 'red')
# 3) C채소
shapiro.test(C)
qqnorm(C); qqline(C, col = 'red')
vege
# 2. anova 검정
# 영가설 : 3개 채소에 대한 도매시장 7곳의 가격 차이는 없다 (mu1 = mu2 = mu3)
# 대안가설 : 3개 채소에 대한 도매시장 7곳의 가격 차이는 있다.
anova(lm(price ~ group, data = vege))
drink <- matrix(c(23,31,13,21,48,23,63,159,119),3,3)
rownames(drink) <- c("반병 이상","반병 이하","못마심")
colnames(drink) <- c("1갑 이상","1갑 이하","안 피움")
addmargins(drink)
drink
## 문제 02.
ex11.2 <- data.frame('1갑이상' =
c(23, 31, 13),
'1갑이하' =
c(21, 48, 23),
'안피움' =
c(63, 159, 119))
colnames(ex11.2) <- c('1갑이상', '1갑이하', '안피움')
rownames(ex11.2) <- c('반병이상', '반병이하', '못마심')
ex11.2
addmargins(ex11.2)
## 문제 02.
ex11.2 <- matrix('1갑이상' =
c(23, 31, 13),
'1갑이하' =
c(21, 48, 23),
'안피움' =
c(63, 159, 119))
addmargins(ex11.2)
## 문제 02.
ex11.2 <- data.frame('1갑이상' =
c(23, 31, 13),
'1갑이하' =
c(21, 48, 23),
'안피움' =
c(63, 159, 119))
colnames(ex11.2) <- c('1갑이상', '1갑이하', '안피움')
rownames(ex11.2) <- c('반병이상', '반병이하', '못마심')
ex11.2
addmargins(ex11.2)
drinK <- matrix(c(23, 31, 13, 21, 48, 23, 63, 159, 119), nrow=3, ncol=3)
drink <- matrix(c(23, 31, 13, 21, 48, 23, 63, 159, 119), nrow=3, ncol=3)
drink
addmargins(drink)
ex11.2
addmargins(ex11.2)
ex11.2 <- matrix(c(23, 31, 13, 21, 48, 23, 63, 159, 119), nrow=3, ncol=3)
colnames(ex11.2) <- c('1갑이상', '1갑이하', '안피움')
rownames(ex11.2) <- c('반병이상', '반병이하', '못마심')
ex11.2
addmargins(drink)
addmargins(ex11.2)
# 검정
chisq.test(ex11.2)
options(digits=7)
# 검정
chisq.test(ex11.2)
chisq.test(x, p=c(85,15)/100)
### 연습문제11. 적합도 / 독립성 검정
## 문제 01. 어느 공정의 부적합품률 15%
##          시료 80개를 추출
##          검사한 결과 불량이 16개
##          유의수준 5%로 적합도 검정을 하시오.
p <- 0.15
q <- 1-p
n <- 80
# 검정
x <- c(64, 16)
chisq.test(x, p=c(85,15)/100)
# 검정
chisq.test(ex11.2)
