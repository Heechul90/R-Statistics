library(readxl)
install.packages("dplyr")
raw_walfare <- read.spss(file = "https://www.dropbox.com/s/b33ob8v0nmig4bw/Koweps_hpc10_2015_beta1.sav?dl=1", to.data.frame = T)
getwd()
raw_walfare <- read.spss(file="Koweps_hpc10_2015_beta1.sav",to.data.frame = T)
View(head(raw_walfare))
head(raw_walfare)
str(raw_walfare)
summary(raw_walfare)
welfare <- raw_walfare
welfare<-rename(welfare, sex=h10_g3,
birth=h10_g4,
marriage=h10_g10,
religion=h10_g11,
income=p1002_Baq1,
code_job=h10_eco9,
code_region=h10_reg7)
names(welfare)
welfare <- dplyr::rename(
welfare,
sex = h10_g3, # 성별
birth = h10_g4, # 채어난 연도
marriage = h10_g10, # 혼인 상태
religion = h10_g11, # 종교
income = p1002_8aq1, # 월급
code_job = h10_eco9, # 직업 코드
code_region = h10_reg7 # 지역 코드
)
welfare <- subset(welfare,
select = c(sex, birth, marriage, religion, income, code_job, code_region))
head(welfare)
class(welfare$sex)
table(welfare$sex)
welfare$sex <- ifelse(welfare$sex == 9, NA, welfare$sex)
table(is.na(welfare$sex))
# 성별 항목 이름 부여
welfare$sex <- ifelse(welfare$sex == 1, "남성","여성")
table(welfare$sex)
qplot(welfare$sex)
### 월급 변수 검토 및 전처리
class(welfare$income)
summary(welfare$income)
qplot(welfare$income)+ xlim(0,1000)
## 월급 이상치 결측처리
welfare$income <- ifelse(
welfare$income %in% c(0,9999),NA,welfare$income)
table(is.na(welfare$sex))
qplot(welfare$income)
# graph 그리기
ggplot(
data = sex_income,
aes(x=sex, y=mean_income)
) + geom_col()
## 성별에 다른 월급 차이 분석하기
sex_income <- welfare %>%
dplyr::filter(!is.na(income)) %>%
dplyr::group_by(sex) %>%
dplyr::summarise(mean_income = mean(income))
sex_income
# graph 그리기
ggplot(
data = sex_income,
aes(x=sex, y=mean_income)
) + geom_col()
## 나이와 월급의 관계
# 1) 결측치 제거
welfare$birth <- ifelse(welfare$birth==999, NA,welfare$birth)
table(is.na(welfare$birth))
# 2) 나이 만들기
welfare$age <- 2015-welfare$birth + 1
qplot(welfare$age)
age_income <- welfare %>%
filter(!is.na(income)) %>%
group_by(age) %>%
summarise(mean_income = mean(income))
age_income
ggplot(
data =  age_income,
aes(
x= age,
y= mean_income
)
) +geom_line()
## 3) 파생변수 만들기 : mutate()
welfare <- welfare %>%
dplyr::mutate(ageg = ifelse(age<30,"초년",ifelse(age <= 59, "중년", "노년")))
table(welfare$ageg)
qplot(welfare$ageg)
sex_income <- welfare %>%
dplyr::filter(!is.na(income)) %>%
group_by(ageg,sex) %>%
summarise(mean_income = mean(income))
x = ageg,
y = mean_income,
fill = sex)) +
geom_col()+
scale_x_discrete(limits = c("초년", "중년","노년"))
## 5) p230 그래프 옆으로 합치기
ggplot(data= sex_income,aes(x=ageg, y=mean_income, fill = sex))+
geom_col(position="dodge") +
scale_x_discrete(limits=c("초년", "중년","노년"))
sex_age <- welfare %>%
filter(!is.na(income)) %>%
group_by(age, sex) %>%
summarise(mean_income = mean(income))
sex_age <- welfare %>%
filter(!is.na(income)) %>%
group_by(age, sex) %>%
summarise(mean_income = mean(income))
head(sex_age)
ggplot(data=sex_age, aes(x=age, y= mean_income, col= sex))+geom_line()
sex_age <- welfare %>%
filter(!is.na(income)) %>%
group_by(age, sex) %>%
summarise(mean_income = mean(income))
x = ageg,
y = mean_income,
fill = sex)) +
geom_col()+
scale_x_discrete(limits = c("초년", "중년","노년"))
sex_income <- welfare %>%
dplyr::filter(!is.na(income)) %>%
group_by(ageg,sex) %>%
summarise(mean_income = mean(income))
ggplot(
data= sex_income,
aes(
x = ageg,
y = mean_income,
fill = sex)) +
geom_col()+
scale_x_discrete(limits = c("초년", "중년","노년"))
welfare <- welfare %>%
dplyr::mutate(ageg = ifelse(age<30,"초년",ifelse(age <= 59, "중년", "노년")))
table(welfare$ageg)
qplot(welfare$ageg)
sex_income <- welfare %>%
dplyr::filter(!is.na(income)) %>%
group_by(ageg,sex) %>%
summarise(mean_income = mean(income))
sex_income <- welfare %>%
dplyr::filter(!is.na(income)) %>%
dplyr::group_by(sex) %>%
dplyr::summarise(mean_income = mean(income))
sex_income
ggplot(
data = sex_income,
aes(x=sex, y=mean_income)
) + geom_col()
welfare$birth <- ifelse(welfare$birth==999, NA,welfare$birth)
table(is.na(welfare$birth))
head(sex_age)
ggplot(data=sex_age, aes(x=age, y= mean_income, col= sex))+geom_line()
setwd('D:/Heechul/R_Statistics/Practice')
library(prob)
library(dplyr)
library(ggplot2)
library(stringr)
library(stringr2)
library(stringr)
setwd('D:/Heechul/R_Statistics/Practice')
### 01.
## 문제 02-1. 시행횟수가 6이고 성공확률이 1/3인 이항분포에서 성공횟수가 3이 될 확률?
n <- 6
p <-1/3
pbinom(3, n=n, p=p)
pbinom(3, size=n, prob=p)
## 문제 02-2. 평균이 170이고 표준편차가 6인 정규분포에서 상위 20%되는 사람들의 키 범위?
mu <- 170
s <- 6
qnorm(0.2, mu=mu, sd=s)
qnorm(0.2, mean=mu, sd=s)
## 문제 02-3. 자유도가 3인 카이제곱분포에서 누적확률이 95%일 때의 값?
df <- 3
pchisq(0.95, df=df)
## 문제 02-4. 자유도가 2인 t-분포에서 누적확률이 0.975일 대의 값?
df <- 2
qt(0.975, df=df)
## 문제 01-5. 표준정규분포에서 확률번수의 값이 1일 때의 누적확률?
mu <- 0
s <- 1
pnorm(1, mean=mu, sd=s)
### 03. 'setosa' 종 Sepal.Length의 모평균에 대한 95% 신뢰구간.
str(iris)
Sepal.L <- iris %>%
filter(setosa) %>%
select(Sepal.Length)
### 03. 'setosa' 종 Sepal.Length의 모평균에 대한 95% 신뢰구간.
str(iris)
Sepal.L <- iris %>%
filter(Species == 'setosa') %>%
select(Sepal.Length)
Sepal.L
xbar <- mean(Sepal.L)
xbar
### 03. 'setosa' 종 Sepal.Length의 모평균에 대한 95% 신뢰구간.
str(iris)
str(Sepal.L)
Sepal.L
xbar <- mean(Sepal.L)
Sepal.L <- iris %>%
filter(Species == 'setosa') %>%
select(Sepal.Length) %>%
summarise(Sepal.L_mean = mean(Sepal.Length))
Sepal.L
Sepal.L <- iris %>%
filter(Species == 'setosa') %>%
select(Sepal.Length)
Sepal.L
Sepal.L_mean <- mean(Sepal.L$Sepal.Length)
sepal.L_mean
Sepal.L_mean
Sepal.L_sd
# 표준편차
Sepal.L_sd <- sd(Sepal.L$Sepal.Length)
Sepal.L_sd
# 표본평균
xbar <- mean(Sepal.L$Sepal.Length)
xbar
# 표본표준편차
s <- sd(Sepal.L$Sepal.Length)
s
# 표본수
n <- n(Sepal.L$Sepal.Length)
n
# 표본수
n <- n(Sepal.L)
n
Sepal.L
# 표본수
n <- length(Sepal.L)
n
# 표본수
n <- length(Sepal.L$Sepal.Length)
n
ll <- xbar - 1.96*sqrt(s/n)
ll
ll <- xbar - 1.96 * s/sqrt(n)
ll
ll <- xbar - (1.96 * s/sqrt(n))
ll
ul <- xbar + (1.96 * s/sqrt(n))
ul
### 04. 한 농구선수가 자유투를 던지면 10번중에서 7번을 성공한다.
p <- 0.7
## 04-1. 이 선수가 자유투를 10번 던져서 9번 이상 성공할 확률?
p <- 0.7
n <- 10
1-pbinorm(8, size=10, prob=0.7)
n <- 10
1-pbinorm(8, size=n, prob=0.7)
1-pbinom(8, size=n, prob=0.7)
## 04-2. 이 선수가 자유투를 10번 던질 때 5번 이상 8번 이하로 성공할 확률?
pbinom(8, size=n, prob=0.7) - pbinom(4, size=10, prob=0.7)
### 05. 2006년 한국인의 1인 1일 평균 알코올 섭취량은 8.1g
###     10명을 무작위 추출한 결과
###     (16.90, 13.21, 15.67, 9.87, 13.15, 9.98, 3.56, 14.50, 8.12, 6.97)
###     평균 알코올 섭취량이 달라졌다고 할 수 있는가?
mu <- 8.1
### 05. 2006년 한국인의 1인 1일 평균 알코올 섭취량은 8.1g
###     10명을 무작위 추출한 결과
###     (16.90, 13.21, 15.67, 9.87, 13.15, 9.98, 3.56, 14.50, 8.12, 6.97)
###     평균 알코올 섭취량이 달라졌다고 할 수 있는가?
al <- c(16.90, 13.21, 15.67, 9.87, 13.15, 9.98, 3.56, 14.50, 8.12, 6.97)
n <- length(al)
al
mu
n
n <- length(al)
n
xbar <- mean(al)
xbar
s <- sd(al)
s
## 정규성 검토
shapiro.test(al)
qqnorm(al); qqline
qqnorm(al); qqline(al)
## 검정
# 영가설 : 평균 알코올 섭취량은 변화가 없다.
# 대안가설 : 평균 알코올 섭취량은 변화가 있다.
t.test(al, mu=8.1, alternative = 'two.sided')
mu
xbar
s
### 07.
## 문제 07-1. subcompact 자동차와 midsize 자동차의 도시 연비를 검정하시오.
mpg
cty07 <- mpg %>%
filter(class %in% c('subcompact', 'midsize')) %>%
select(class, cty) %>%
group_by(class)
cty07
cty07_mean <- mean(cty07$cty[class=='subcompact'])
cty_mean <- mpg %>%
filter(class %in% c('subcompact', 'midsize')) %>%
select(class, cty) %>%
group_by(class) %>%
summarise(cty_mean = mean(cty))
cty_mean
cty_s <- mpg %>%
filter(class %in% c('subcompact', 'midsize')) %>%
select(class, cty) %>%
group_by(class) %>%
summarise(cty_s = sd(cty))
cty_s
cty_sd <- mpg %>%
filter(class %in% c('subcompact', 'midsize')) %>%
select(class, cty) %>%
group_by(class) %>%
summarise(cty_s = sd(cty))
cty_sd
cty_n <- mpg %>%
filter(class %in% c('subcompact', 'midsize')) %>%
select(class, cty) %>%
group_by(class) %>%
summarise(cty_n = n(cty))
cty_n <- mpg %>%
filter(class %in% c('subcompact', 'midsize')) %>%
select(class, cty) %>%
group_by(class) %>%
summarise(cty_n = n())
cty_n
cty_sd <- mpg %>%
filter(class %in% c('subcompact', 'midsize')) %>%
select(class, cty) %>%
group_by(class) %>%
summarise(cty_sd = sd(cty))
cty_sd
cty07.1 <- mpg %>%
filter(class %in% c('subcompact', 'midsize')) %>%
select(class, cty)
cty07.1
## 정규성 검토
shapiro.test(cty07.1[class == subcompact])
## 정규성 검토
shapiro.test(cty07.1[class == 'subcompact'])
cty07.1[class == 'subcompact']
cty07.1[class == 'subcompact']
cty07.1[class = 'subcompact']
sub_cty <- mpg %>%
filter(class == 'subcompact') %>%
select(class, cty)
sub_cty
## 정규성 검토
shapiro.test(sub_cty)
## 정규성 검토
shapiro.test(sub_cty[,2])
## 정규성 검토
shapiro.test(sub_cty[2,])
## 정규성 검토
shapiro.test(sub_cty[,2])
select(class, cty)
cty07.1
head(mtcars)
select(class, cty)
### 07.
## 문제 07-1. subcompact 자동차와 midsize 자동차의 도시 연비를 검정하시오.
mpg
cty07.1 <- mpg %>%
filter(class %in% c('subcompact', 'midsize'))
cty07.1
## 등분산성 검정
# 영가설 : 분산이 같다
# 대안가설 : 분산이 다른다
# 1. 분산의 동일성 검정
# 영가설 : 오토/수동 집단의 분산은 서로 동일하다.
# 대안가설 : 오토/수동 집단의 분산은 서로 다르다.
var.test(cty07.1$cty ~ cty07.1$class)
mpg3 <- mpg %>%
filter(class %in% c('subcompact', 'midsize'))
## 1. 분산의 동일성 검정
# 영가설 : subcompact 자동차의 분산과 midsize 자도창의 분산은 서로 동일하다. (V1 / V2 = 1)
# 대안가설 : subcompact 자동차의 분산과 midsize 자도창의 분산은 서로 다르다. (V1 / V2 != 1)
var.test(mpg3$hwy ~ mpg3$class)
## 등분산성 검정
# 영가설 : 분산이 같다
# 대안가설 : 분산이 다른다
var.test(cty07.1$cty ~ cty07.1$class)
5.201e-07
print(5.201e-07)
## 평균 동일성 검정
t.test(cty07.1$cty ~ cty07.1$class, mu=0, alternative='two.sided', var.equal=f)
## 평균 동일성 검정
t.test(cty07.1$cty ~ cty07.1$class, mu=0, alternative='two.sided', var.equal=F)
## 07-2. 일반 위발류(r)와 고급 휘발유(p)의 고속도로 연비을 검정하시오.
mpg
hwy07.2 <- mpg %>%
filter(fl %in% c('r', 'p'))
hwy07.2
## 등분산성 검정
# 영가설 : 분산이 같다.
# 대안가설 : 분산이 다르다.
var.test(hwy07.2$hwy ~ hwy07.2$fl)
## 평균 동일성 검정
# 영가설 : hwy 차이가 없다
# 대안가설 : hwy 차이가 있다.
t.test(hwy07.2$hwy ~ hwy07.2$fl, mu=0, var.equal=F)
### 09. 키와 몸무게의 곡선회귀분석을 통한 2차 회귀식을 구하라
women
fit <- lm(weight ~ height, data =women)
summary(fit)
fit <- lm(weight ~ height + I(height^2), data =women)
summary(fit)
dbinom(3, size=n, prob=p)
## 문제 01-2. 평균이 170이고 표준편차가 6인 정규분포에서 상위 20%되는 사람들의 키 범위?
mu <- 170
s <- 6
1-qnorm(0.2, mean=mu, sd=s)
### 01.
## 문제 01-1. 시행횟수가 6이고 성공확률이 1/3인 이항분포에서 성공횟수가 3이 될 확률?
n <- 6
p <-1/3
dbinom(3, size=n, prob=p)
qnorm(0.2, mean=mu, sd=s)
qnorm(0.8, mean=mu, sd=s)
## 문제 01-3. 자유도가 3인 카이제곱분포에서 누적확률이 95%일 때의 값?
df <- 3
## 문제 01-5. 표준정규분포에서 확률번수의 값이 1일 때의 누적확률?
mu <- 0
s <- 1
pnorm(1, mean=mu, sd=s)
### 06. 정규분포에서 from <= x <= to 의 확률을 구하는 함수
###     rangenorm(from, to, mean, sd)을 작성하고
###     rangenorm(-1.96, 1.96, 0, 1)의 값을 구하시오.
rangenorm(-1.96, 1.96, 0, 1)
### 06. 정규분포에서 from <= x <= to 의 확률을 구하는 함수
###     rangenorm(from, to, mean, sd)을 작성하고
###     rangenorm(-1.96, 1.96, 0, 1)의 값을 구하시오.
pnorm(1.96, mu=0, sd=1) - pnorm(-1.96, mu=0, sd=1)
### 06. 정규분포에서 from <= x <= to 의 확률을 구하는 함수
###     rangenorm(from, to, mean, sd)을 작성하고
###     rangenorm(-1.96, 1.96, 0, 1)의 값을 구하시오.
pnorm(1.96, mean=0, sd=1) - pnorm(-1.96, mean=0, sd=1)
## 2차 회귀식
## weight.hat = 261.87818 - (7.34832*height1) + (0.08306*heigh1^2)
height1 <- 165
weight.hat = 261.87818 - (7.34832*height1) + (0.08306*heigh1^2)
## 2차 회귀식
## weight.hat = 261.87818 - (7.34832*height1) + (0.08306*heigh1^2)
height1 <- 165
weight.hat = 261.87818 - (7.34832*height1) + (0.08306*heigh1^2)
weight.hat = 261.87818 - (7.34832*height1) + (0.08306*height1^2)
weight.hat
weight.hat = 261.87818 + (0.08306*height1^2)
weight.hat
### 09. 키와 몸무게의 곡선회귀분석을 통한 2차 회귀식을 구하라
women
fit <- lm(weight ~ height + I(height^2), data =women)
summary(fit)
weight.hat = 261.87818 - (7.34832*height1)
weight.hat
weight.hat = 261.87818 - (7.34832*height1) + (0.08306*height1^2)
weight.hat
fit <- lm(weight ~ height, data =women)
summary(fit)
weight.hat = -87.51667 + (3.45000*height1)
weight.hat
fit <- lm(weight ~ height, data =women)
summary(fit)
## 2차 회귀식
## weight.hat = 261.87818 - (7.34832*height1) + (0.08306*heigh1^2)
height1 <- 180
weight.hat <- -87.51667 + (3.45000*height1)
weight.hat
fit <- lm(weight ~ height +I(height^2), data =women)
summary(fit)
### 07.
## 문제 07-1. subcompact 자동차와 midsize 자동차의 도시 연비를 검정하시오.
mpg
cty07.1 <- mpg %>%
filter(class %in% c('subcompact', 'midsize'))
cty07.1
cty07.1(mpg[cty])
cty07.1(mpg$cty)
cty07.1 <- mpg %>%
filter(class %in% c('subcompact', 'midsize'))
cty07.1(mpg$cty)
library(stringr)
cty07.1(mpg$cty)
cty07.1[mpg$cty]
### 05. 2006년 한국인의 1인 1일 평균 알코올 섭취량은 8.1g
###     10명을 무작위 추출한 결과
###     (16.90, 13.21, 15.67, 9.87, 13.15, 9.98, 3.56, 14.50, 8.12, 6.97)
###     평균 알코올 섭취량이 달라졌다고 할 수 있는가?
al <- c(16.90, 13.21, 15.67, 9.87, 13.15, 9.98, 3.56, 14.50, 8.12, 6.97)
al
str(al)
cty07.1 <- mpg %>%
filter(class %in% c('subcompact', 'midsize'))
cty07.1
sub.cty <- mpg %>%
filter(class == 'subcompact') %>%
select(cty)
sub.cty
shapiro.test(sub.cty)
str(sub.cty)
sub.cty <- as.numeric(sub.cty)
cty07.1
## 등분산성 검정
# 영가설 : 분산이 같다
# 대안가설 : 분산이 다른다
var.test(cty07.1$cty ~ cty07.1$class)
str(cty07.1)
cty07.1 <- mpg %>%
filter(class %in% c('subcompact', 'midsize')) %>%
select(cty, class)
str(cty07.1)
## 등분산성 검정
# 영가설 : 분산이 같다
# 대안가설 : 분산이 다른다
var.test(cty07.1$cty ~ cty07.1$class)
