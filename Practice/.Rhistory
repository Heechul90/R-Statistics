lines(f_x, f_y, lty=2, lwd=2, col='blue')
hist(f.64.mean, probability = T, xlim = c(0.6, 1.6), ylim = c(0, 8),
main='표본크기=64',
xlab = '', ylab = '',
col = 'orange', border = 'red')
f_x <- seq(min(f.64.mean), max(f.64.mean), length.out = 1000)
f_y <- dnorm(x=f_x, mean = ex, sd = sqrt(varx/64))
lines(f_x, f_y, lty=2, lwd=2, col='blue')
set.seed(9)
n <- 1000
df1 <- 50
df2 <- 50
ex <- df2 / (df2-2)
varx <- (2*(df2^2)*(df1+df2-2)) / (df1*((df2-2)^2)*(df2-4))
f.1.mean <- rep(NA, n)
f.2.mean <- rep(NA, n)
f.4.mean <- rep(NA, n)
f.8.mean <- rep(NA, n)
f.16.mean <- rep(NA, n)
f.32.mean <- rep(NA, n)
f.64.mean <- rep(NA, n)
f.128.mean <- rep(NA, n)
f.256.mean <- rep(NA, n)
f.512.mean <- rep(NA, n)
for(i in 1:n) {
f.1.mean[i] <- mean(rf(1, df1=df1, df2=df2))
f.2.mean[i] <- mean(rf(2, df1=df1, df2=df2))
f.4.mean[i] <- mean(rf(4, df1=df1, df2=df2))
f.8.mean[i] <- mean(rf(8, df1=df1, df2=df2))
f.16.mean[i] <- mean(rf(16, df1=df1, df2=df2))
f.32.mean[i] <- mean(rf(32, df1=df1, df2=df2))
f.64.mean[i] <- mean(rf(64, df1=df1, df2=df2))
f.128.mean[i] <- mean(rf(128, df1=df1, df2=df2))
f.256.mean[i] <- mean(rf(256, df1=df1, df2=df2))
f.512.mean[i] <- mean(rf(512, df1=df1, df2=df2))
}
options(digits = 4)
c(mean(f.1.mean), sd(f.1.mean))
c(mean(f.2.mean), sd(f.2.mean))
c(mean(f.4.mean), sd(f.4.mean))
c(mean(f.8.mean), sd(f.8.mean))
c(mean(f.16.mean), sd(f.16.mean))
c(mean(f.32.mean), sd(f.32.mean))
c(mean(f.64.mean), sd(f.64.mean))
c(mean(f.128.mean), sd(f.128.mean))
c(mean(f.256.mean), sd(f.256.mean))
c(mean(f.512.mean), sd(f.512.mean))
par(mfrow=c(2,2))
hist(f.4.mean, probability = T, xlim = c(0.6, 1.6), ylim = c(0, 8),
main='표본크기=4',
xlab = '', ylab = '',
col = 'orange', border = 'red')
f_x <- seq(min(f.4.mean), max(f.4.mean), length.out = 1000)
f_y <- dnorm(x=f_x, mean = ex, sd = sqrt(varx/4))
lines(f_x, f_y, lty=2, lwd=2, col='blue')
hist(f.16.mean, probability = T, xlim = c(0.6, 1.6), ylim = c(0, 8),
main='표본크기=16',
xlab = '', ylab = '',
col = 'orange', border = 'red')
f_x <- seq(min(f.16.mean), max(f.16.mean), length.out = 1000)
f_y <- dnorm(x=f_x, mean = ex, sd = sqrt(varx/16))
lines(f_x, f_y, lty=2, lwd=2, col='blue')
hist(f.32.mean, probability = T, xlim = c(0.6, 1.6), ylim = c(0, 8),
main='표본크기=32',
xlab = '', ylab = '',
col = 'orange', border = 'red')
f_x <- seq(min(f.64.mean), max(f.64.mean), length.out = 1000)
f_y <- dnorm(x=f_x, mean = ex, sd = sqrt(varx/64))
lines(f_x, f_y, lty=2, lwd=2, col='blue')
hist(f.64.mean, probability = T, xlim = c(0.6, 1.6), ylim = c(0, 8),
main='표본크기=64',
xlab = '', ylab = '',
col = 'orange', border = 'red')
f_x <- seq(min(f.64.mean), max(f.64.mean), length.out = 1000)
f_y <- dnorm(x=f_x, mean = ex, sd = sqrt(varx/64))
lines(f_x, f_y, lty=2, lwd=2, col='blue')
mtext("표본 변화에 따른 f분포, 자유도=(50, 50)", side = 3, line=1, outer=T)
setwd('D:/Heechul/R_Statistics/Practice')
## 예제 5-1. 유효성
x <- seq(-3, 3, by = 0.2)
y <- dnorm(x)
y.1 <- dnorm(x, sd=sqrt(1/3))
y.2 <- dnorm(x, sd=sqrt(7/18))
pnorm(0.1, sd=sqrt(1/3)) - pnorm(-0.1, sd=sqrt(1/3))
pnorm(0.1, sd=sqrt(7/18)) - pnorm(-0.1, sd=sqrt(7/18))
plot(x, y, type = 'l', ylim = c(0, 0.8), axes = F,
ylab = '',
xlab = '',
lwd = 3, col = 'yellow')
lines(x,y.1, col='red', lwd=3)
lines(x,y.2, col='green', lty=2, lwd=3)
## 예제 5-1. 유효성
par(mfrow = c(1,1))
x <- seq(-3, 3, by = 0.2)
y <- dnorm(x)
y.1 <- dnorm(x, sd=sqrt(1/3))
y.2 <- dnorm(x, sd=sqrt(7/18))
pnorm(0.1, sd=sqrt(1/3)) - pnorm(-0.1, sd=sqrt(1/3))
pnorm(0.1, sd=sqrt(7/18)) - pnorm(-0.1, sd=sqrt(7/18))
plot(x, y, type = 'l', ylim = c(0, 0.8), axes = F,
ylab = '',
xlab = '',
lwd = 3, col = 'yellow')
lines(x,y.1, col='red', lwd=3)
lines(x,y.2, col='green', lty=2, lwd=3)
axis(1)
plot(x, y, type = 'l', ylim = c(0, 0.8), axes = F,
ylab = '',
xlab = '',
lwd = 3, col = 'yellow')
lines(x,y.1, col='red', lwd=3)
lines(x,y.2, col='green', lty=2, lwd=3)
pnorm(0.1, sd=sqrt(1/3)) - pnorm(-0.1, sd=sqrt(1/3))
pnorm(0.1, sd=sqrt(7/18)) - pnorm(-0.1, sd=sqrt(7/18))
## 예제5-2. 유효성 모의실험
options(digits = 3)
set.seed(1)
mean.seq <- function(x) {
n <- length(x)
sum <- 0
n2 <- 0
for(i in 1:n) {
newx <- i * x[i]
sum <- sum + newx
n2 <- n2 +i
}
return(sum / n2)
}
y1 <- rep(NA, 1000)
y2 <- rep(NA, 1000)
for(i in 1:1000) {
smp <- rnorm(3)
y1[i] <- mean(smp)
y2[i] <- mean.seq(smp)
}
n1 <- length(y1[(y1 > -0.1) & (y1 < 0.1)])
n2 <- length(y2[(y2 > -0.1) & (y2 < 0.1)])
data.frame(mean=mean(y1), var=var(y1), n=n1)
data.frame(mean=mean(y2), var=var(y2), n=n2)
par(mfrow= c(1,2))
hist(y1, probability = T, xlim = c(-2, 2), ylim = c(0, 0.65),
main = '(x1+x2+x3)/ 3',
xlab = '',
ylab = '',
col = 'orange', border = 'red')
hist(y2, probability = T, xlim = c(-2, 2), ylim = c(0, 0.65),
main = '(1*x1+2*x2+6*x3)/ 6',
xlab = '',
ylab = '',
col = 'orange', border = 'red')
## 예제 5-4. 모평균에 대한 95% 신뢰구간
set.seed(9)
n <- 10
x <- 1:100
y <- seq(-3, 3, by = 0.01)
smps <- matrix(rnorm(n * length(x)), ncol = n)
smps
xbar <- apply(smps, 1, mean)
se <- 1 / sqrt(10)
alpha <- 0.05
z <- qnorm(1 - alpha/2)
ll <- xbar - z*se
ul <- xbar + z*se
par(mfrow=c(1,1))
plot(y, type='n', xlim=c(1,100), ylim=c(-1.5, 1.5), cex.lab=1.8,
main='95% Confidence Interval for Population mean',
xlab='trial',
ylab='z')
abline(h=0, col='red', lty=2)
l.c <- rep(NA, length(x))
l.c <- ifelse(ll * ul >0, 'red', 'black')
arrows(1:length(x), ll, 1:length(x), ul, code=3, angle=90, length=0.02, col=l.c, lwd=1.5)
library(prob)
# 표본비율(N, pq/n)
phat <- 0.5
qhat <- 0.5
ul <- 1.96*sqrt(phat*qhat/n)
ll <- -1.96*sqrt(phat*qhat/n)
ul
ll
# 표본비율(N, pq/n)
n <- 100
ll <- -1.96*sqrt(phat*qhat/n)
ul <- 1.96*sqrt(phat*qhat/n)
ul
ll
# 표본비율(N, pq/n)
n <- 1000
phat <- 0.5
qhat <- 0.5
ll <- -1.96*sqrt(phat*qhat/n)
ul <- 1.96*sqrt(phat*qhat/n)
ll
ul
ll <- phat-1.96*sqrt(phat*qhat/n)
ul <- phat+1.96*sqrt(phat*qhat/n)
ll
ul
prop.test(500, 1000, 0.5, alternative = 'two.sided', conf.level = 0.95)
## 문제 02. 임의 추출 100명
##          4/5가 선호,
##          모비율 p에 대한 신뢰도 95의 신뢰 구간?
n <- 100
phat <- 0.8
qhat <- 0.2
ll <- phat-1.96*sqrt(phat*qhat/n)
ul <- phat+1.96*sqrt(phat*qhat/n)
ll
ul
## 문제 03. 무작위로 1000명 추출,
##          430명이 흡연
##          모비율의 90% 신뢰구간은?
n <- 1000
phat <- 0.43
qhat <- 1-0.43
ll <- phat-1.645*sqrt(phat*qhat/n)
ul <- phat+1.645*sqrt(phat*qhat/n)
ll
ul
### 연습문제05. 1-Sample T 테스트
## 문제 01. A회사의 건전지의 수명시간 1000
##          무작위로 뽑은 10개
##          980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017
##          모집단과 같다고 할수 있는가?
bat <- c(980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017)
n <- length(bat)
n
xbar <- mean(bat)
mu <- 1000
sdbar <- sd(bat)
sdbar
alpha <- 0.05/2
t <- xbar-mu/(sdbar/sqrt(n))
t
xbar
sdbar
t <- xbar-mu/sdbar/sqrt(n)
t
t <- xbar-mu
t
sdbar/sqrt(n)
t/sdbar/sqrt(n)
t <- (xbar-mu) / (sdbar/sqrt(n))
t
# 유의 수준
c.u <- qt(alpha, df=n-1)
c.u
p.value <- 1-pt(t, df=n-1)
p.value
t.test(bat, mu=mu, alternative = 'greater')
xbar
sdbar
## 문제 02. 학생들의 평균성적은 55점.
##          0교시 수업 후 성적 58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39
##          0교시 수업을 시행한 후, 학생들의 성적은 올랐다고 할 수 있는가?
# H0 : 학생들의 성
# H1 : 학생들의 성
score <- c(58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39)
mu <- 55
xbar <- mean(score)
sd <- sd(score)
n <- length(score)
t <- (xbar-mu) / (sd/sqrt(n))
t
# 유의 수준
alpha <- 0.05
c.u <- qt(alpha, df=n-1)
c.u
c.u <- 1 - qt(alpha, df=n-1)
c.u
# 유의 확률
p.value <- 1 - pt(t, df=n-1)
p.value
t
t.test(score, mu=mu, alternative = 'greater')
t
c.u
p.value
t.test(bat, mu=mu, alternative = 'two.sided')
t.test(score, mu=mu, alternative = 'greater')
t
c.u
p.value
xbar
sd
t
al <- c(15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97)
mu <- 8.1
xbar <- mean(al)
xbar
sd <- sd(al)
sd
n <- length(al)
n
# 통계량
t <- (xbar-mu) / (sd/sqrt(n))
t
# 유의수준(양쪽)
alpha <- 0.5/2
# 유의수준(양쪽)
alpha <- 0.05/2
alpha
c.u <- qt(alpha, df=n-a)
c.u <- qt(alpha, df=n-1)
c.u# 유의확률
# 유의확률
p.value <- pt(t, df=n-1)
p.value
t.test(al, mu=mu, alternative = 'two.sided')
t
c.u # 양쪽으로 -2.262157, 2.262157
p.value
n
t
xbar <- mean(al)
xbar
sd <- sd(al)
sd
mu <- 8.1
n <- length(al)
n
# 통계량
t <- (xbar-mu) / (sd/sqrt(n))
t
# 유의수준(양쪽)
alpha <- 0.05/2
alpha
c.u <- qt(alpha, df=n-1)
c.u # 양쪽으로 -2.262157, 2.262157
# 유의확률
p.value <- pt(t, df=n-1)
p.value
t.test(al, mu=mu, alternative = 'two.sided')
# 유의확률
p.value <- 1- pt(t, df=n-1)
p.value
t
### 연습문제05. 1-Sample T 테스트
## 문제 01. A회사의 건전지의 수명시간 1000
##          무작위로 뽑은 10개
##          980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017
##          모집단과 같다고 할수 있는가?
# H0 : 평균(mu) 같다
# H1 : 평균(mu) 같지 않다
bat <- c(980, 1008, 968, 1032, 1012, 996, 1021, 1002, 996, 1017)
n <- length(bat)
n
mu <- 1000
mu
xbar <- mean(bat)
xbar
sdbar <- sd(bat)
sdbar
# 통계량
t <- (xbar-mu) / (sdbar/sqrt(n))
t
# 유의 수준
c.u <- qt(alpha, df=n-1)
t
# 유의 수준
alpha <- 0.05/2
c.u <- qt(alpha, df=n-1)
c.u
# 유의 확률
p.value <- 1-pt(t, df=n-1)
p.value
t.test(bat, mu=mu, alternative = 'two.sided')
t
# 유의 확률
p.value <- pt(t, df=n-1)
p.value
# 유의 확률
p.value <- 1- pt(t, df=n-1)
p.value
1-t
# 통계량
t <- (xbar-mu) / (sdbar/sqrt(n))
t
1-c.u
c.u
# 유의 수준
alpha <- 0.05
c.u <- qt(alpha, df=n-1)
c.u
1-c.u
# 유의 수준
alpha <- 0.05/2
c.u <- qt(alpha, df=n-1)
c.u
# 유의 확률
p.value <- 1- pt(t, df=n-1)
p.value
c.u
t.test(bat, mu=mu, alternative = 'two.sided')
p.value
p.value*2
t
p.value*2
## 문제 02. 학생들의 평균성적은 55점.
##          0교시 수업 후 성적 58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39
##          0교시 수업을 시행한 후, 학생들의 성적은 올랐다고 할 수 있는가?
# H0 : 학생들의 mu = 55 or mu <= 55
# H1 : 학생들의 mu > 55
score <- c(58, 49, 39, 99, 32, 88, 62, 30, 55, 65, 44, 55, 57, 53, 88, 42, 39)
mu <- 55
xbar <- mean(score)
xbar
sd <- sd(score)
sd
n <- length(score)
n
# 통계량
t <- (xbar-mu) / (sd/sqrt(n))
t
# 유의 수준
alpha <- 0.05
# 유의 수준(한쪽:오른쪽)
alpha <- 0.05
c.u <- 1 - qt(alpha, df=n-1)
c.u
# 유의 확률
p.value <- 1 - pt(t, df=n-1)
p.value
t.test(score, mu=mu, alternative = 'greater')
al <- c(15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97)
mu <- 8.1
xbar <- mean(al)
xbar
sd <- sd(al)
sd
n <- length(al)
n
sdbar <- sd(bat)
sdbar
al <- c(15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97)
mu <- 8.1
xbar <- mean(al)
xbar
sd <- sd(al)
sd
n <- length(al)
n
# 통계량
t <- (xbar-mu) / (sd/sqrt(n))
t
## 문제 03. 한국인의 1인 1일 평균 알코올 섭취량이 8.1
##          무작위로 뽑은 섭취량 15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97
##          평균 알코올 섭취량이 달라졌다고 할 수 있는가?
# H0 : 한국인의 1인 1일 평균 알코올 섭취량은 8.1로 변화가 없다 mu = 8.1
# H1 : 한국인의 1인 1일 평균 알코올 섭취량은 변화가 있다. m != 8.1
al <- c(15.50, 11.21, 12.67, 8.87, 12.15, 9.88, 2.06, 14.50, 0, 4.97)
mu <- 8.1
xbar <- mean(al)
xbar
sd <- sd(al)
sd
n <- length(al)
n
# 통계량
t <- (xbar-mu) / (sd/sqrt(n))
t
# 유의수준(양쪽)
alpha <- 0.05/2
alpha
c.u <- qt(alpha, df=n-1)
c.u <- qt(alpha, df=n-1)
c.u                              # 양쪽으로 -2.262157, 2.262157
# 유의확률
p.value <- 1- pt(t, df=n-1)
p.value
t.test(al, mu=mu, alternative = 'two.sided')
p.value
p.value*2
t
xbar
sd
t
t.test(al, mu=mu, alternative = 'two.sided')
# 모비율 95% 신뢰도 구간
# phat -1.96*sqrt(phat*qhat/n) <= m <= phat + 1.96*sqrt(phat*qhat/n)
a <- phat -1.96*sqrt(phat*qhat/n)
# 모비율 95% 신뢰도 구간
# phat -1.96*sqrt(phat*qhat/n) <= m <= phat + 1.96*sqrt(phat*qhat/n)
a <- phat - (1.96 * sqrt(phat*qhat/n))
phat <- 0.5
qhat <- 0.5
# 모비율 95% 신뢰도 구간
# phat -1.96*sqrt(phat*qhat/n) <= m <= phat + 1.96*sqrt(phat*qhat/n)
a <- phat - (1.96 * sqrt(phat*qhat/n))
qhat <- 1 - phat
# 모비율 95% 신뢰도 구간
# phat -1.96*sqrt(phat*qhat/n) <= m <= phat + 1.96*sqrt(phat*qhat/n)
a <- phat - (1.96 * sqrt(phat*qhat/n))
a
b <- phat + (1.96 * sqrt(phat*qhat/n))
b-a
b-a <- 2 * (1.96 * sqrt(phat*qhat/n))
b_a <- 2 * (1.96 * sqrt(phat*qhat/n))
b_a
b-a <- 2*(1.96 * sqrt(phat*qhat/n))
2*(1.96 * sqrt(0.5*0.5/n))
2*1.96*0.5/sqrt(n) = 0.14
2*1.96*0.5
2*1.96
2*1.96*0.5
1.96*1.96/0.14*0.14
1.96*1.96
0.14*0.14
3.8416/0.0196
(2*1.96*sqrt(phat*qhat)) / 0.14
14^2
n = 14^2
